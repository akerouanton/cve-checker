package sources

import (
    "github.com/NiR-/cve-checker/datastore"
    "github.com/NiR-/cve-checker/distro"
)

var sources = make(map[string]Source)

type Source interface {
    // Check if this source should be enabled
    Enabled(d distro.Distribution) (bool)
    Update(store datastore.Store, d distro.Distribution) (error)
    Cleanup()
}

func RegisterSource(name string, source Source) {
    sources[name] = source
}

func Sources() map[string]Source {
    return sources
}
