package cve

import (
    "testing"
)

func TestDoesItAffectDetectsOlderPkgIsVulnerable(t *testing.T) {
    cve := CVE{
        AffectedPackages: []AffectedPackage{
            {
                Name: "linux",
                PatchedVersion: "4.9.65-3+deb9u2",
            },
        },
    }

    if !cve.DoesItAffect(Package{Name: "linux", Version: "4.9.65-3"}) {
        t.FailNow()
    }
}

func TestDoesItAffectDetectsPatchedPkgIsNotVulnerable(t *testing.T) {
    cve := CVE{
        AffectedPackages: []AffectedPackage{
            {
                Name: "linux",
                PatchedVersion: "4.9.65-3+deb9u2",
            },
        },
    }

    if cve.DoesItAffect(Package{Name: "linux", Version: "4.9.65-3+deb9u2"}) {
        t.FailNow()
    }
}
